/*!
 LivelyCart Pro
 version: 3.x
 --------------------------------------------------------------------- 
 Build Timestamp: 1569677944
 Build Date: Sat Sep 28 2019 19:09:04 GMT+0530 (India Standard Time)
--------------------------------------------------------------------- */
!function(){"use strict";angular.module("FileManagerApp",["ngMessages","ngAnimate","ngSanitize","ui.router","angular-loading-bar","angularFileUpload","selectize","ngNotify","ngDialog","lw.core.utils","lw.auth","lw.data.datastore","lw.data.datatable","lw.security.main","lw.form.main","app.service","app.notification","app.form","FileManagerAppEngine","app.FileManagerEngine"]).run(["__Auth","$state","$rootScope",function(e,o,l){e.verifyRoute(o),l.__ngSupport=window.__ngSupport}]).config(["$stateProvider","$urlRouterProvider","$interpolateProvider",function(e,o,l){l.startSymbol("[["),l.endSymbol("]]")}])}(),function(){"use strict";angular.module("FileManagerAppEngine",[]).service("FileManagerService",["$rootScope","$state","appNotify","ngDialog",function(e,o,l,n){this.closeAllDialog=function(){n.closeAll()},this.showDialog=function(e,o,l){return n.open({template:o.templateUrl,controller:o.controller,controllerAs:o.controllerAs,closeByEscape:!1,closeByDocument:!1,data:e}).closePromise.then(function(e){return l.call(this,e)})},this.confirmDialog=function(e,o){return n.openConfirm({template:e.templateUrl,className:"ngdialog-theme-default",showClose:!0,plain:!!e.plain},function(e){return o.call(this,e)})}}]).controller("FileManagerController",["$rootScope","__DataStore","$scope","__Auth","appServices","appNotify","__Utils","FileManagerService",function(e,l,o,n,r,t,i,a){var g=this,s=__globals.getAppJSItem("file_manager_config");g.pageStatus=!1,n.refresh(function(e){g.auth_info=e}),g.unhandledError=function(){t.error(__globals.getReactionMessage(19))},g.currentDir="",g.currentFolderData="",e.$on("lw.page.css_styles",function(e,o){g.pageCSSStyles=o.header_bg_color}),e.$on("lw.events.state.change_start",function(){r.closeAllDialog()}),e.$on("lw.form.event.fetch.started",__globals.showFormLoader),e.$on("lw.datastore.event.fetch.finished",__globals.hideFormLoader),e.$on("lw.form.event.process.error",g.unhandledError),e.$on("lw.datastore.event.fetch.error",g.unhandledError),g.showUploadNewFileDialog=function(){a.showDialog({currentDir:g.currentDir},{templateUrl:__globals.getTemplateURL("file-manager.upload-file-dialog")},function(e){g.retrieveFiles()})},g.showImageFileDialog=function(e){a.showDialog({fileData:e},{templateUrl:__globals.getTemplateURL("file-manager.image-file-dialog")},function(e){})},g.useFile=function(e){if(window.opener&&!window.opener.closed){var o,l=new Array,n=location.search;if(n)for(var r=(n=n.substring(1)).split("&"),t=0;t<r.length;t++)l[(o=r[t].split("="))[0]]=unescape(o[1]);var i=l.CKEditor,a=window.opener.CKEDITOR.instances[i]._.filebrowserSe,s=a.getDialog(),c=a.filebrowser.target||null;if(c){var u=c.split(":"),f=s.getContentElement(u[0],u[1]);f&&(f.setValue(e.previewUrl),s.selectPage(u[0]))}window.close()}else g.showImageFileDialog(e)},g.showAddFolderDialog=function(){a.showDialog({currentDir:g.currentDir},{templateUrl:__globals.getTemplateURL("file-manager.add-folder-dialog")},function(e){g.retrieveFiles()})},g.showRenameFolderDialog=function(e,o){a.showDialog({currentDir:g.currentDir,name:e,folder_relative_path:o},{templateUrl:__globals.getTemplateURL("file-manager.edit-folder-dialog")},function(e){g.retrieveFiles()})},g.showRenameFileDialog=function(e){a.showDialog({currentDir:g.currentDir,fileData:e},{templateUrl:__globals.getTemplateURL("file-manager.rename-file-dialog")},function(e){g.retrieveFiles()})},g.retrieveFiles=function(){g.showLoader=!1,l.fetch(i.apiURL("file_manager.files")+"?currentDir="+g.currentDir+"&type="+s.type,{fresh:!0}).success(function(e){var o=e.data;r.processResponse(e,null,function(){g.files=o.files,g.currentDir=o.currentDir,g.currentFolderData=o.currentFolderData,g.showLoader=!1})})},g.showFolderFiles=function(e){e&&(g.currentDir=e,g.retrieveFiles())},g.backToParent=function(e){g.currentDir=e,g.retrieveFiles()},g.isLoggedIn=function(){return g.auth_info.authorized},g.isAdmin=function(){return g.isLoggedIn()&&1===g.auth_info.designation},g.getFullName=function(){if(g.isLoggedIn())return g.auth_info.profile.full_name},g.deleteFile=function(e,o){r.confirmDialog({templateUrl:"lw-file-delete-dialog.ngtemplate"}).then(function(e){l.post({apiURL:"file_manager.file.delete",filename:o},{filename:o}).success(function(e){r.processResponse(e,null,function(){g.retrieveFiles()})})})},g.deleteFolder=function(e,o){r.confirmDialog({templateUrl:"lw-folder-delete-dialog.ngtemplate"}).then(function(e){l.post({apiURL:"file_manager.folder.delete",folder:o},{folderName:o}).success(function(e){r.processResponse(e,null,function(){g.retrieveFiles()})})})};var c=i.apiURL("file_manager.file.download");g.downloadFileUrl=function(e){return c+"?filename="+e},g.retrieveFiles()}])}(),function(){"use strict";window.angular.module("app.FileManagerEngine",[]).controller("FileManagerMasterController",["$scope","__DataStore","__Form","$stateParams",function(e,o,l,n){}]).controller("AddFolderDialogController",["$scope","__Form","appServices","appNotify",function(o,e,l,n){var r=this,t=o.ngDialogData;(r=e.setup(r,"add_folder_form","folderData")).submit=function(){e.process("file_manager.folder.add",r).success(function(e){l.processResponse(e,null,function(e){o.closeThisDialog({folder_added:!0})})})},r.folderData.currentDir=t.currentDir,r.closeDialog=function(){o.closeThisDialog()}}]).controller("UploadFileDialogController",["$scope","__DataStore","appServices","appNotify","__Utils","FileUploader",function(e,o,l,n,r,t){var i,a=this,s=e.ngDialogData.currentDir;(i=a.uploader=new t({url:r.apiURL("file_manager.upload")+"?currentDir="+s,autoUpload:!0,headers:{"X-XSRF-TOKEN":r.getXSRFToken()}})).filters.push({name:"uploaderFilter",fn:function(){return this.queue.length<1e3}}),a.currentUploadedFileCount=0,i.onAfterAddingAll=function(){a.showLoader=!0},i.onSuccessItem=function(e,o){l.processResponse(o,null,function(){o.data;a.currentUploadedFileCount++})},i.onCompleteAll=function(){a.showLoader=!1,0<a.currentUploadedFileCount&&n.success(a.currentUploadedFileCount+" file uploaded"),e.closeThisDialog(),a.currentUploadedFileCount=0},a.closeDialog=function(){e.closeThisDialog()}}]).controller("ImageFileDialogController",["$scope","__DataStore","appServices",function(e,o){var l=e.ngDialogData;this.fileData=l.fileData,this.closeDialog=function(){e.closeThisDialog()}}]).controller("RenameFolderDialogController",["$scope","__Form","appServices","appNotify",function(o,e,l,n){var r=this,t=o.ngDialogData;(r=e.setup(r,"rename_folder_form","folderData")).submit=function(){e.process("file_manager.folder.rename",r).success(function(e){l.processResponse(e,null,function(e){o.closeThisDialog({folder_updated:!0})})})},(r=e.updateModel(r,{name:t.name,existing_name:t.name,currentDir:t.currentDir,folder_relative_path:t.folder_relative_path})).closeDialog=function(){o.closeThisDialog()}}]).controller("RenameFileDialogController",["$scope","__Form","appServices","appNotify",function(o,e,l,n){var r=this,t=o.ngDialogData,i=t.fileData;(r=e.setup(r,"rename_file_form","fileData")).submit=function(){e.process("file_manager.file.rename",r).success(function(e){l.processResponse(e,null,function(e){o.closeThisDialog({file_updated:!0})})})},r.fileExtension=i.extension,(r=e.updateModel(r,{name:i.baseName,existing_name:i.name,currentDir:t.currentDir,file_relative_path:i.relativePath})).closeDialog=function(){o.closeThisDialog()}}])}(window);